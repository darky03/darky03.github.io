<!DOCTYPE html>
<html>
	<head>
		<title>Tic Tac Toe</title>
		<style>
			body {
				font-family: "Arial";
				padding: 0; 
				margin: 0;
			}
			td
			{

				margin: 0;
				padding: 30px;

				/*ont-size: 20px;*/
				border: 1px solid black;
			}

		</style>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script>
			$(document).ready(function() {
				let arrayList = [
					["","",""],
					["","",""],
					["","",""]
				];
				let TURN_PLAYER = "X";
				$("#playerturn").html("Turn for player: " + TURN_PLAYER);
				let gameStop =  false;
				$("td").click(function() {
					if($(this).html() == "" && !gameStop) {
						$(this).html(TURN_PLAYER);
						
						let id = $(this).attr("id");
						let indices = id.split("x");
						indices[0] = parseInt(indices[0]);
						indices[1] = parseInt(indices[1]);

						arrayList[indices[0]][indices[1]] = TURN_PLAYER;
						console.log(arrayList);
						TURN_PLAYER = (TURN_PLAYER == "X" ? "O" : "X");
						$("#playerturn").html("Turn for player: " + TURN_PLAYER);
						//console.log("Turn for player: " + TURN_PLAYER);
						checkWinner();
					}
				})
				function checkWinner() {
					let patterns = 
					[
						[ [0,0], [0,1], [0,2] ],
						[ [1,0], [1,1], [1,2] ],
						[ [2,0], [2,1], [2,2] ],
						[ [0,0], [1,0], [2,0] ],
						[ [0,1], [1,1], [2,1] ],
						[ [0,2], [1,2], [2,2] ],
						[ [0,0], [1,1], [2,2] ],
						[ [2,0], [1,1], [0,2] ]
					];
					let wpi = -1;
					let stop = false;
					let old = "";
					for(let i = 0; i < patterns.length; i++)
					{
						let idxI = patterns[i][0][0];
						let idxJ = patterns[i][0][1];
						old = arrayList[idxI][idxJ];
						for(let j = 1; j < patterns[i].length; j++)
						{
							idxI = patterns[i][j][0];
							idxJ = patterns[i][j][1];
							console.log(arrayList[idxI][idxJ] + " , " + old);
							if(arrayList[idxI][idxJ] == old && old != "")
							{
								stop = true;
								continue;
							} else {
								stop = false;
								old = "";
								break;
							}
						}
						if(stop) {
							wpi = i;
							break;
						}
					}
					if(stop && old != "") {
						console.log("We have a winner: " + old);
						$("#winnerName").html(old);
						$("#overlay_main").css("display","block");
						gameStop = true;
						// we paint those boxes
						let idStr = "";
						for(let i = 0; i < patterns[wpi].length; i++) {
							idStr = patterns[wpi][i][0] + "x" +  patterns[wpi][i][1];
							console.log("ID String: " + idStr);
							$("td#" + idStr).css("background-color","red");
						}
					}

				}
			});
		</script>
	</head>
	<body>
		<div id="overlay_main" style="display: none;">
			<div id="overlaybg" style="position: fixed; left: 0; top: 0; height: 0; width: 100%; height: 100%; background-color: white; opacity: 0.8; z-index: 1;"></div>
			<div id="overlayfg" style="position: fixed; top: 30%; left: 35%; height: 0; width: 100%; height: 100%; z-index: 2; font-size: 30px;">Player '<span id="winnerName"></span>' has won the game!</div>

		</div>
		<div>
			<font size = "6">
				Tic Tac Toe game designed in leisure
			</font>
		</div>
		<hr>
		<br/>
		<div id="playerturn" style="font-size: 20px;"></div>
		
		<div align=center>
			<table cellspacing=0>
				<tr>
					<td id="0x0"></td>
					<td id="0x1"></td>
					<td id="0x2"></td>
				</tr>
				<tr>
					<td id="1x0"></td>
					<td id="1x1"></td>
					<td id="1x2"></td>
				</tr>
				<tr>
					<td id="2x0"></td>
					<td id="2x1"></td>
					<td id="2x2"></td>
				</tr>
			</table>
		</div>
	</body>
</html>